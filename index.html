<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TerNix Online</title>
    <style>
        body { margin: 0; overflow: hidden; background: #0055ff; font-family: "Arial", sans-serif; }
        canvas { display: block; width: 100vw; height: 100vh; background: #87CEEB; }

        header { position: absolute; top: 0; left: 0; width: 100%; height: 40px; background: #0044ee; color: white; display: flex; align-items: center; padding: 0 15px; box-sizing: border-box; z-index: 100; border-bottom: 2px solid #002288; }
        header button { background: #fff; border: 1px solid #000; margin-right: 10px; cursor: pointer; font-weight: bold; padding: 2px 10px; font-size: 12px; }

        #chat-log { position: absolute; top: 50px; left: 15px; width: 350px; height: 180px; color: white; text-shadow: 1px 1px 2px #000; pointer-events: none; z-index: 50; overflow: hidden; font-size: 14px; }

        #stats-panel { position: absolute; top: 50px; right: 15px; background: rgba(255,255,255,0.9); border: 2px solid #000; padding: 8px; width: 180px; z-index: 50; }
        .bar-bg { width: 100%; height: 12px; background: #555; border: 1px solid #000; margin-top: 4px; }
        #hp-fill { width: 100%; height: 100%; background: #ff0000; }
        #xp-fill { width: 0%; height: 100%; background: #00ff00; }

        #chat-bar { position: absolute; bottom: 0; left: 0; width: 100%; background: #fff; border-top: 3px solid #333; display: flex; z-index: 200; box-sizing: border-box; padding: 10px; }
        #chat-input { width: 100%; border: none; outline: none; font-size: 18px; }

        .win { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #eee; border: 2px solid #333; width: 400px; display: none; z-index: 300; box-shadow: 8px 8px 0 rgba(0,0,0,0.2); }
        .win-header { background: #0044ee; color: white; padding: 5px 10px; font-weight: bold; display: flex; justify-content: space-between; }
        
        #launcher { position: fixed; inset: 0; background: #0055ff; z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; }
    </style>
</head>
<body>

<div id="launcher">
    <h1>TerNix</h1>
    <input type="text" id="username" placeholder="Name..." style="padding: 12px; width: 250px; font-size: 18px; border: none;">
    <button onclick="startGame()" style="margin-top:20px; padding: 10px 60px; cursor: pointer; background: #00aa00; color: white; border: none; font-weight: bold; font-size: 18px;">PLAY</button>
</div>

<header>
    <b style="margin-right:20px; font-size: 20px;">TerNix</b>
    <button onclick="toggle('home-win')">Home</button>
    <button onclick="toggle('games-win')">Games</button>
    <div style="margin-left:auto; font-size:12px;">Fierens: 50 | Hex: 100</div>
</header>

<div id="chat-log"></div>

<div id="stats-panel">
    <div style="font-size:10px; font-weight:bold;">HEALTH</div>
    <div class="bar-bg"><div id="hp-fill"></div></div>
    <div style="font-size:10px; font-weight:bold; margin-top:8px;">LEVEL <span id="lvl-txt">1</span></div>
    <div class="bar-bg"><div id="xp-fill"></div></div>
</div>

<div id="home-win" class="win">
    <div class="win-header">Home <span onclick="toggle('home-win')" style="cursor:pointer">X</span></div>
    <div style="padding:20px;"><h2 id="welcome">Hello!</h2><p>Welcome to TerNix Alpha.</p></div>
</div>

<div id="games-win" class="win">
    <div class="win-header">Games <span onclick="toggle('games-win')" style="cursor:pointer">X</span></div>
    <div style="padding:20px;"><div style="background:#fff; border:1px solid #ccc; padding:10px;"><b>The Crossroads</b><br><br><button onclick="toggle('games-win')">Teleport</button></div></div>
</div>

<canvas id="game"></canvas>

<div id="chat-bar">
    <span style="font-weight:bold; margin-right:10px;">&gt;</span>
    <input type="text" id="chat-input" placeholder='Click "/" to chat'>
</div>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const chatInput = document.getElementById('chat-input');
    const chatLog = document.getElementById('chat-log');

    let w, h, pX = 400, pY = 300, username = "Player";
    let xp = 0, lvl = 1;
    const keys = {};

    function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
    window.onresize = resize; resize();

    function startGame() {
        const n = document.getElementById('username').value;
        if(n) { username = n; document.getElementById('welcome').innerText = "Hello, " + n + "!"; }
        document.getElementById('launcher').style.display = 'none';
        requestAnimationFrame(draw);
    }

    window.onkeydown = (e) => {
        if(e.key === '/') { e.preventDefault(); chatInput.focus(); }
        keys[e.code] = true;
    }
    window.onkeyup = (e) => keys[e.code] = false;

    chatInput.onkeypress = (e) => {
        if(e.key === 'Enter' && chatInput.value !== "") {
            chatLog.innerHTML += `<div><b>${username}:</b> ${chatInput.value}</div>`;
            chatInput.value = "";
            chatLog.scrollTop = chatLog.scrollHeight;
            chatInput.blur();
        }
    }

    function draw() {
        // Отрисовка мира
        ctx.fillStyle = '#87CEEB'; ctx.fillRect(0,0,w,h); // Небо
        ctx.fillStyle = '#448844'; ctx.fillRect(0, h/2, w, h/2); // Трава

        // Сетка (имитация 3D)
        ctx.strokeStyle = "rgba(0,0,0,0.1)";
        for(let i=0; i<w; i+=50) { ctx.beginPath(); ctx.moveTo(i, h/2); ctx.lineTo(i, h); ctx.stroke(); }

        if(document.activeElement !== chatInput) {
            let moving = false;
            if(keys['KeyW']) { pY -= 3; moving = true; }
            if(keys['KeyS']) { pY += 3; moving = true; }
            if(keys['KeyA']) { pX -= 3; moving = true; }
            if(keys['KeyD']) { pX += 3; moving = true; }
            
            if(moving) {
                xp += 0.2;
                if(xp >= 100) { xp = 0; lvl++; document.getElementById('lvl-txt').innerText = lvl; }
                document.getElementById('xp-fill').style.width = xp + "%";
            }
        }

        // Персонаж (Серый, Квадратный)
        // Тень
        ctx.fillStyle = "rgba(0,0,0,0.2)";
        ctx.beginPath(); ctx.ellipse(pX, pY+10, 20, 10, 0, 0, Math.PI*2); ctx.fill();
        // Тело
        ctx.fillStyle = '#888'; ctx.fillRect(pX-20, pY-40, 40, 60);
        ctx.strokeRect(pX-20, pY-40, 40, 60);
        // Голова
        ctx.fillStyle = '#ffdbac'; ctx.fillRect(pX-15, pY-70, 30, 30);
        ctx.strokeRect(pX-15, pY-70, 30, 30);
        // Никнейм сверху
        ctx.fillStyle = 'white'; ctx.textAlign = 'center'; ctx.font = "bold 14px Arial";
        ctx.fillText(username, pX, pY-80);

        requestAnimationFrame(draw);
    }

    function toggle(id) {
        let e = document.getElementById(id);
        e.style.display = (e.style.display === 'block') ? 'none' : 'block';
    }
</script>
</body>
</html>

