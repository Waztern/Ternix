<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>TerNix Online</title>
    <style>
        body { margin: 0; overflow: hidden; background: #0055ff; font-family: "Arial", sans-serif; }
        canvas { display: block; width: 100vw; height: 100vh; background: #87CEEB; }

        /* ВЕРХНЯЯ ПАНЕЛЬ */
        header { position: absolute; top: 0; left: 0; width: 100%; height: 40px; background: #0044ee; color: white; display: flex; align-items: center; padding: 0 15px; box-sizing: border-box; z-index: 100; border-bottom: 2px solid #002288; }
        header button { background: #fff; border: 1px solid #000; margin-right: 10px; cursor: pointer; font-weight: bold; padding: 2px 10px; }

        /* ЧАТ (СЛЕВА СВЕРХУ) */
        #chat-log { position: absolute; top: 50px; left: 15px; width: 300px; height: 200px; color: white; text-shadow: 1px 1px 2px #000; pointer-events: none; z-index: 50; overflow: hidden; font-size: 14px; }

        /* ЗДОРОВЬЕ И XP (СПРАВА СВЕРХУ) */
        #stats-panel { position: absolute; top: 50px; right: 15px; background: rgba(255,255,255,0.9); border: 2px solid #000; padding: 10px; width: 180px; z-index: 50; }
        .bar-bg { width: 100%; height: 12px; background: #555; border: 1px solid #000; margin-top: 5px; }
        #hp-fill { width: 100%; height: 100%; background: #ff0000; }
        #xp-fill { width: 10%; height: 100%; background: #00ff00; }

        /* ПОЛОСА ЧАТА (СНИЗУ ВО ВСЮ ШИРИНУ) */
        #chat-bar { position: absolute; bottom: 0; left: 0; width: 100%; background: #fff; border-top: 3px solid #333; display: flex; z-index: 200; box-sizing: border-box; }
        #chat-input { width: 100%; padding: 12px; border: none; outline: none; font-size: 16px; }

        /* ОКНА */
        .win { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #eee; border: 2px solid #333; width: 400px; display: none; z-index: 300; box-shadow: 10px 10px 0 rgba(0,0,0,0.2); }
        .win-header { background: #0044ee; color: white; padding: 5px 10px; font-weight: bold; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

<header>
    <b style="margin-right:20px;">TerNix</b>
    <button onclick="toggle('home-win')">Home</button>
    <button onclick="toggle('games-win')">Games</button>
    <div style="margin-left:auto; font-size:12px;">Fierens: 50 | Hex: 100</div>
</header>

<div id="chat-log"></div>

<div id="stats-panel">
    <div style="font-size:11px; font-weight:bold;">HEALTH</div>
    <div class="bar-bg"><div id="hp-fill"></div></div>
    <div style="font-size:11px; font-weight:bold; margin-top:10px;">LEVEL 1</div>
    <div class="bar-bg"><div id="xp-fill"></div></div>
</div>

<div id="home-win" class="win">
    <div class="win-header">Home <span onclick="toggle('home-win')" style="cursor:pointer">X</span></div>
    <div style="padding:20px;">
        <h2>Welcome to TerNix!</h2>
        <p>Ваш уровень: 1. Удачной игры!</p>
    </div>
</div>

<div id="games-win" class="win">
    <div class="win-header">Games <span onclick="toggle('games-win')" style="cursor:pointer">X</span></div>
    <div style="padding:20px;">
        <div style="background:#fff; border:1px solid #ccc; padding:10px;">
            <b>The Crossroads</b><br><br>
            <button onclick="toggle('games-win')">Play</button>
        </div>
    </div>
</div>

<canvas id="game"></canvas>

<div id="chat-bar">
    <input type="text" id="chat-input" placeholder='Click "/" to chat'>
</div>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const chatInput = document.getElementById('chat-input');
    const chatLog = document.getElementById('chat-log');

    let w, h, pX = 0, pY = 0;
    const keys = {};

    function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
    window.onresize = resize; resize();

    window.onkeydown = (e) => {
        if(e.key === '/') { e.preventDefault(); chatInput.focus(); }
        keys[e.code] = true;
    }
    window.onkeyup = (e) => keys[e.code] = false;

    chatInput.onkeypress = (e) => {
        if(e.key === 'Enter' && chatInput.value !== "") {
            chatLog.innerHTML += `<div><b>Player:</b> ${chatInput.value}</div>`;
            chatInput.value = "";
            chatInput.blur();
        }
    }

    function draw() {
        // Отрисовка "3D" мира
        ctx.fillStyle = '#87CEEB'; ctx.fillRect(0,0,w,h); // Небо
        ctx.fillStyle = '#448844'; ctx.fillRect(0, h/2, w, h/2); // Земля

        if(document.activeElement !== chatInput) {
            if(keys['KeyW']) pY += 2; if(keys['KeyS']) pY -= 2;
            if(keys['KeyA']) pX += 2; if(keys['KeyD']) pX -= 2;
        }

        // Персонаж (Квадратный стиль)
        ctx.fillStyle = '#888'; ctx.fillRect(w/2 - 20, h/2 - 40, 40, 60); 
        ctx.strokeRect(w/2 - 20, h/2 - 40, 40, 60);
        ctx.fillStyle = '#ffdbac'; ctx.fillRect(w/2 - 15, h/2 - 70, 30, 30);
        ctx.strokeRect(w/2 - 15, h/2 - 70, 30, 30);

        ctx.fillStyle = 'white'; ctx.textAlign = 'center'; ctx.font = "bold 14px Arial";
        ctx.fillText("PLAYER", w/2, h/2 - 80);

        requestAnimationFrame(draw);
    }
    draw();

    function toggle(id) {
        let e = document.getElementById(id);
        e.style.display = (e.style.display === 'block') ? 'none' : 'block';
    }
</script>
</body>
</html>
